# Include PyFEM libraries
from pyfem.mesh    import *
from pyfem.fem     import *
from pyfem.equilib import *

block = Block3D()
block.make_box([0,0,0], [1])
block.set_divisions(30,6,6)

mesh = Mesh(block)
mesh.generate()
mesh.write_mesh("tmesh")

domain = Domain(mesh)

# Setting element types and parameters
domain.elems.set_elem_model(EqElasticSolid({"E": 1.0E5, "nu": 0.3}))

# Filtering nodes
fixed_nodes  = domain.nodes.with_x(0.0).with_y_in(0.0, 1.0).with_z_in(0.0, 1.0)
loaded_nodes = domain.nodes.with_x(1.0).with_y_in(0.0, 1.0).with_z_in(0.0, 1.0)

# Boundary conditions
fixed_nodes .set_brys({"ux": 0.0, "uy": 0.0, "uz": 0.0})
loaded_nodes.set_brys({"fx": 1.0})

#Setting solver and solving
domain.set_solver(SolverEq())
domain.solver.set_incs(5)

domain.solver.solve()
domain.solver.write_output()

